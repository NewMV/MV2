name: ðŸš€ TradingView 500 Stocks (5 shards â†’ 5 mins)
on: workflow_dispatch

jobs:
  scrape-500:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        shard: [0,1,2,3,4]  # 5 shards Ã— 100 = 500 stocks
      max-parallel: 5
    timeout-minutes: 15
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        pip install --quiet selenium gspread beautifulsoup4 webdriver-manager lxml
    
    - name: Run OPTIMIZED scraper
      env:
        START_INDEX: ${{ (matrix.shard * 100) }}
        END_INDEX: ${{ (matrix.shard * 100) + 99 }}
        GSPREAD_CREDENTIALS: ${{ secrets.GSPREAD_CREDENTIALS }}
      run: python run_scraper.py
